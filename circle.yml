machine:
  python:
    version: 3.5.2

dependencies:
  pre:
    - git config --global user.email pior@pbastida.net
    - git config --global user.name 'Pior Bastida (CircleCI)'
  override:
    - pip install -U wheel bumpversion twine
    - pip install -r requirements-test.txt
    - pip install -e .

test:
  override:
    - pytest

deployment:
  pypi:
    branch: pypi
    commands:
      - bumpversion patch --commit --tag
      - git push origin pypi --tags
      - python setup.py sdist bdist_wheel
      - twine upload -u $PYPI_USERNAME -p $PYPI_PASSWORD dist/*
