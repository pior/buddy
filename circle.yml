machine:
  python:
    version: 3.5.2

dependencies:
  override:
    - git config --global user.email pior@pbastida.net
    - git config --global user.name 'Pior Bastida (CircleCI)'
    - git config --global push.default matching

    - pip install -U pip wheel
    - pip install -U bumpversion twine
    - pip install -r requirements-test.txt
    - pip install .

test:
  override:
    - pytest

deployment:
  pypi:
    branch: master
    commands:
      - bumpversion patch
      - git push origin master --tags
      - python setup.py sdist bdist_wheel
      - twine upload -u $PYPI_USERNAME -p $PYPI_PASSWORD dist/*
